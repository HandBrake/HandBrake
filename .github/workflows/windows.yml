name: Windows Build

on: [push, pull_request]

jobs:
  build:
    name: Build on Windows
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@master
      with:
        fetch-depth: 1
        
    - name: Environment Setup
      run: |
        choco install wget
        wget https://nsis.sourceforge.io/mediawiki/images/c/c9/Inetc.zip
        mkdir plugins
        move Inetc.zip plugins
        cd plugins        
        7z x Inetc.zip
        dir
  
    - name: NuGet Restore
      run: |
         choco install nuget.commandline
         cd win/CS/
         nuget restore HandBrake.sln
        
    - name: Build Windows GUI
      run: |      
        set PATH=C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin;%PATH%
        echo %PATH%
        msbuild -version
        msbuild win\cs\build.xml /t:Nightly
